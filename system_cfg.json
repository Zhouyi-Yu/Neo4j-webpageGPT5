{
  "directed": true,
  "multigraph": false,
  "graph": {},
  "nodes": [
    {
      "type": "entry",
      "label": "User Question Input",
      "color": "#4CAF50",
      "id": "START"
    },
    {
      "type": "process",
      "label": "Classify Intent\n(LLM Call)",
      "color": "#2196F3",
      "id": "classify_intent"
    },
    {
      "type": "process",
      "label": "Normalize Intent\n(Expand Departments)",
      "color": "#2196F3",
      "id": "normalize_intent"
    },
    {
      "type": "decision",
      "label": "Selected User ID\nProvided?",
      "color": "#FF9800",
      "id": "check_selected_user"
    },
    {
      "type": "process",
      "label": "Set authorUserId\nPromote to AUTHOR_MAIN",
      "color": "#2196F3",
      "id": "set_user_id"
    },
    {
      "type": "decision",
      "label": "Author Field\nPresent?",
      "color": "#FF9800",
      "id": "check_author_field"
    },
    {
      "type": "process",
      "label": "Extract Name\n(LLM Call)",
      "color": "#2196F3",
      "id": "extract_name"
    },
    {
      "type": "process",
      "label": "Resolve Author\n(Exact + Fuzzy Search)",
      "color": "#2196F3",
      "id": "resolve_author"
    },
    {
      "type": "decision",
      "label": "Multiple\nCandidates?",
      "color": "#FF9800",
      "id": "check_candidates"
    },
    {
      "type": "output",
      "label": "Return Candidate List\nfor User Selection",
      "color": "#F44336",
      "id": "return_candidates"
    },
    {
      "type": "decision",
      "label": "Single Match\nFound?",
      "color": "#FF9800",
      "id": "check_single_match"
    },
    {
      "type": "process",
      "label": "Set Author Info\n& UserId",
      "color": "#2196F3",
      "id": "set_author_info"
    },
    {
      "type": "decision",
      "label": "Intent is\nOPEN_QUESTION?",
      "color": "#FF9800",
      "id": "promote_intent"
    },
    {
      "type": "process",
      "label": "Promote to\nAUTHOR_PUBLICATIONS",
      "color": "#2196F3",
      "id": "promote_to_author"
    },
    {
      "type": "decision",
      "label": "Is Template Intent\n& Has Required Slots?",
      "color": "#FF9800",
      "id": "check_template"
    },
    {
      "type": "process",
      "label": "Generate Cypher\n(LLM Call)",
      "color": "#2196F3",
      "id": "generate_cypher"
    },
    {
      "type": "process",
      "label": "Run Cypher Query\n(Neo4j)",
      "color": "#9C27B0",
      "id": "run_cypher"
    },
    {
      "type": "decision",
      "label": "Is Topic\nIntent?",
      "color": "#FF9800",
      "id": "check_topic_intent"
    },
    {
      "type": "process",
      "label": "Semantic Search\nPublications (Vector)",
      "color": "#9C27B0",
      "id": "semantic_search_topic"
    },
    {
      "type": "decision",
      "label": "DB Rows or\nSemantic Hits?",
      "color": "#FF9800",
      "id": "check_empty_results"
    },
    {
      "type": "process",
      "label": "Semantic Search UofA\n(Fallback)",
      "color": "#9C27B0",
      "id": "semantic_fallback"
    },
    {
      "type": "process",
      "label": "Synthesize Answer\n(LLM Call)",
      "color": "#2196F3",
      "id": "synthesize_answer"
    },
    {
      "type": "decision",
      "label": "No DB Rows but\nSemantic Hits?",
      "color": "#FF9800",
      "id": "check_second_pass"
    },
    {
      "type": "process",
      "label": "Recursive Semantic\nAnswer (LLM)",
      "color": "#2196F3",
      "id": "recursive_semantic"
    },
    {
      "type": "output",
      "label": "Return Template\nResult",
      "color": "#4CAF50",
      "id": "return_template_result"
    },
    {
      "type": "process",
      "label": "Semantic Search UofA\n(Vector)",
      "color": "#9C27B0",
      "id": "semantic_search_uofa"
    },
    {
      "type": "decision",
      "label": "Semantic Hits\nFound?",
      "color": "#FF9800",
      "id": "check_semantic_hits"
    },
    {
      "type": "output",
      "label": "Return 'No Results'",
      "color": "#F44336",
      "id": "return_no_results"
    },
    {
      "type": "process",
      "label": "Generate Author\nCypher (LLM)",
      "color": "#2196F3",
      "id": "generate_author_cypher"
    },
    {
      "type": "process",
      "label": "Run Author Cypher\n(Neo4j)",
      "color": "#9C27B0",
      "id": "run_author_cypher"
    },
    {
      "type": "process",
      "label": "Synthesize Final\nAuthor Answer (LLM)",
      "color": "#2196F3",
      "id": "synthesize_final_author"
    },
    {
      "type": "output",
      "label": "Return Semantic\nResult",
      "color": "#4CAF50",
      "id": "return_semantic_result"
    },
    {
      "type": "exit",
      "label": "Response to User",
      "color": "#4CAF50",
      "id": "END"
    }
  ],
  "links": [
    {
      "source": "START",
      "target": "classify_intent"
    },
    {
      "source": "classify_intent",
      "target": "normalize_intent"
    },
    {
      "source": "normalize_intent",
      "target": "check_selected_user"
    },
    {
      "label": "Yes",
      "source": "check_selected_user",
      "target": "set_user_id"
    },
    {
      "label": "No",
      "source": "check_selected_user",
      "target": "check_author_field"
    },
    {
      "source": "set_user_id",
      "target": "check_template"
    },
    {
      "label": "Yes",
      "source": "check_author_field",
      "target": "resolve_author"
    },
    {
      "label": "No",
      "source": "check_author_field",
      "target": "extract_name"
    },
    {
      "source": "extract_name",
      "target": "resolve_author"
    },
    {
      "source": "resolve_author",
      "target": "check_candidates"
    },
    {
      "label": "Yes (>1)",
      "source": "check_candidates",
      "target": "return_candidates"
    },
    {
      "label": "No",
      "source": "check_candidates",
      "target": "check_single_match"
    },
    {
      "source": "return_candidates",
      "target": "END"
    },
    {
      "label": "Yes",
      "source": "check_single_match",
      "target": "set_author_info"
    },
    {
      "label": "No",
      "source": "check_single_match",
      "target": "check_template"
    },
    {
      "source": "set_author_info",
      "target": "promote_intent"
    },
    {
      "label": "Yes",
      "source": "promote_intent",
      "target": "promote_to_author"
    },
    {
      "label": "No",
      "source": "promote_intent",
      "target": "check_template"
    },
    {
      "source": "promote_to_author",
      "target": "check_template"
    },
    {
      "label": "Yes",
      "source": "check_template",
      "target": "generate_cypher"
    },
    {
      "label": "No",
      "source": "check_template",
      "target": "semantic_search_uofa"
    },
    {
      "source": "generate_cypher",
      "target": "run_cypher"
    },
    {
      "source": "run_cypher",
      "target": "check_topic_intent"
    },
    {
      "label": "Yes",
      "source": "check_topic_intent",
      "target": "semantic_search_topic"
    },
    {
      "label": "No",
      "source": "check_topic_intent",
      "target": "check_empty_results"
    },
    {
      "source": "semantic_search_topic",
      "target": "check_empty_results"
    },
    {
      "label": "No",
      "source": "check_empty_results",
      "target": "semantic_fallback"
    },
    {
      "label": "Yes",
      "source": "check_empty_results",
      "target": "synthesize_answer"
    },
    {
      "source": "semantic_fallback",
      "target": "synthesize_answer"
    },
    {
      "source": "synthesize_answer",
      "target": "check_second_pass"
    },
    {
      "label": "Yes",
      "source": "check_second_pass",
      "target": "recursive_semantic"
    },
    {
      "label": "No",
      "source": "check_second_pass",
      "target": "return_template_result"
    },
    {
      "source": "recursive_semantic",
      "target": "return_template_result"
    },
    {
      "source": "return_template_result",
      "target": "END"
    },
    {
      "source": "semantic_search_uofa",
      "target": "check_semantic_hits"
    },
    {
      "label": "No",
      "source": "check_semantic_hits",
      "target": "return_no_results"
    },
    {
      "label": "Yes",
      "source": "check_semantic_hits",
      "target": "generate_author_cypher"
    },
    {
      "source": "return_no_results",
      "target": "END"
    },
    {
      "source": "generate_author_cypher",
      "target": "run_author_cypher"
    },
    {
      "source": "run_author_cypher",
      "target": "synthesize_final_author"
    },
    {
      "source": "synthesize_final_author",
      "target": "return_semantic_result"
    },
    {
      "source": "return_semantic_result",
      "target": "END"
    }
  ]
}